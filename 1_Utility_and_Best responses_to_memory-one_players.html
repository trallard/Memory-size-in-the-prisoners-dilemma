

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Stability of defection, optimisation of strategies and the limits of memory in the PD. &#8212; Stability of defection, optimisation of strategies and the limits of memory in the Prisoner&#39;s Dilemma.</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .secondtoggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          

<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Stability of defection, optimisation of strategies and the limits of memory in the Prisoner's Dilemma.</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  
</nav>
<p class="sidebar_footer">Powered by <a href='https://jupyterbook.org'>Jupyter Book</a></p>
</div>


          


          
<main class="col py-md-3 pl-md-5 bd-content overflow-auto" role="main">
    
    
      <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col topbar-main">
        <button id="navbar-toggler" class="navbar-toggler" type="button" data-toggle="collapse" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"><i class="fas fa-download"></i><span class="dropdown-trigger-text">Download</span></button>
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="_sources/1_Utility_and_Best responses_to_memory-one_players.ipynb.txt"><button type="button" class="btn btn-secondary topbarbtn">.ipynb</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" onClick="window.print()">.pdf</button>
            </div>
        </div>

        <!-- Launch buttons -->
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"><i class="fas fa-rocket"></i><span class="dropdown-trigger-text">Launch</span></button>
            <div class="dropdown-buttons">
                
                <a class="binder-button" href="https://mybinder.org/v2/gh/trallard/Memory-size-in-the-prisoners-dilemma/master?urlpath=tree/nbs/1_Utility_and_Best responses_to_memory-one_players.ipynb"><button type="button" class="btn btn-secondary topbarbtn"><img class="binder-button-logo" src="_static/images/logo_binder.svg" alt="Interact on binder">Binder</button></a>
                
                
                
            </div>
        </div>
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>


    </div>
</div>
    
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 col-xxl-7">
        
              <div>
                
  <div class="section" id="stability-of-defection-optimisation-of-strategies-and-the-limits-of-memory-in-the-pd">
<h1>Stability of defection, optimisation of strategies and the limits of memory in the PD.<a class="headerlink" href="#stability-of-defection-optimisation-of-strategies-and-the-limits-of-memory-in-the-pd" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="utility-and-best-responses-to-memory-one-players">
<h1>1. Utility and Best responses to memory-one players<a class="headerlink" href="#utility-and-best-responses-to-memory-one-players" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">opt_mo</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sym</span>

<span class="n">sym</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/sklearn/externals/joblib/__init__.py:15: FutureWarning: sklearn.externals.joblib is deprecated in 0.21 and will be removed in 0.23. Please import this functionality directly from joblib, which can be installed with: pip install joblib. If this warning is raised when loading pickled models, you may need to re-serialize those models with scikit-learn 0.21+.
  warnings.warn(msg, category=FutureWarning)
/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/sklearn/utils/deprecation.py:144: FutureWarning: The sklearn.metrics.scorer module is  deprecated in version 0.22 and will be removed in version 0.24. The corresponding classes / functions should instead be imported from sklearn.metrics. Anything that cannot be imported from sklearn.metrics is now part of the private API.
  warnings.warn(message, FutureWarning)
</pre>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">axelrod</span> <span class="k">as</span> <span class="nn">axl</span>

<span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">font</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="s2">&quot;bold&quot;</span><span class="p">}</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;font&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">font</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p_1</span><span class="p">,</span> <span class="n">p_2</span><span class="p">,</span> <span class="n">p_3</span><span class="p">,</span> <span class="n">p_4</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;p_1, p_2, p_3, p_4&quot;</span><span class="p">)</span>
<span class="n">q_1</span><span class="p">,</span> <span class="n">q_2</span><span class="p">,</span> <span class="n">q_3</span><span class="p">,</span> <span class="n">q_4</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;q_1, q_2, q_3, q_4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_1</span><span class="p">,</span> <span class="n">p_2</span><span class="p">,</span> <span class="n">p_3</span><span class="p">,</span> <span class="n">p_4</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">q_1</span><span class="p">,</span> <span class="n">q_2</span><span class="p">,</span> <span class="n">q_3</span><span class="p">,</span> <span class="n">q_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="utility">
<h1>Utility<a class="headerlink" href="#utility" title="Permalink to this headline">¶</a></h1>
<p>The markov chain <span class="math notranslate nohighlight">\(M\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">opt_mo</span><span class="o">.</span><span class="n">mem_one_match_markov_chain</span><span class="p">(</span><span class="n">player</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">opponent</span><span class="o">=</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tex</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;tex&#39;</span><span class="p">)</span>
<span class="n">img_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;img&#39;</span><span class="p">)</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tex</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;m_matrix.tex&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;M = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">M</span><span class="p">))))</span>
</pre></div>
</div>
</div>
</div>
<p>Let <span class="math notranslate nohighlight">\(v\)</span> be the stationary vector of <span class="math notranslate nohighlight">\(M\)</span>, where <span class="math notranslate nohighlight">\(M\)</span> is the transition matrix <span class="math notranslate nohighlight">\(M(p,q)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pi_1</span><span class="p">,</span> <span class="n">pi_2</span><span class="p">,</span> <span class="n">pi_3</span><span class="p">,</span> <span class="n">pi_4</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;pi_1, pi_2, pi_3, pi_4&quot;</span><span class="p">)</span>
<span class="n">pi</span> <span class="o">=</span> <span class="p">(</span><span class="n">pi_1</span><span class="p">,</span> <span class="n">pi_2</span><span class="p">,</span> <span class="n">pi_3</span><span class="p">,</span> <span class="n">pi_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ss</span> <span class="o">=</span> <span class="n">opt_mo</span><span class="o">.</span><span class="n">steady_states</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Once the markovian matrix is defined we can calculate the stable states of the matrix.
The stable states multiplied  by the scores of each state return the score of a player. The payoff matrices for <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> equivilant are: <span class="math notranslate nohighlight">\(S_{p} = (R, S, T, P)\)</span> &amp; <span class="math notranslate nohighlight">\(S_{q} = (R, S, T, P)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">ss</span><span class="p">[</span><span class="n">pi_1</span><span class="p">]],</span> <span class="p">[</span><span class="n">ss</span><span class="p">[</span><span class="n">pi_2</span><span class="p">]],</span> <span class="p">[</span><span class="n">ss</span><span class="p">[</span><span class="n">pi_3</span><span class="p">]],</span> <span class="p">[</span><span class="n">ss</span><span class="p">[</span><span class="n">pi_4</span><span class="p">]]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;R, S, T, P&quot;</span><span class="p">)</span>
<span class="n">payoffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">R</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">utility</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<p>To test this we can have a defector play against a defector. We know that the score should be 1. Similar for two cooperators the score should be 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="p">(</span>
    <span class="n">utility</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">p_1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_4</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q_1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q_2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q_3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q_4</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span> <span class="o">==</span> <span class="mi">0</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="n">utility</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">p_1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_4</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q_1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q_2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q_3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q_4</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span> <span class="o">==</span> <span class="mi">5</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span>
    <span class="n">utility</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
        <span class="p">{</span><span class="n">p_1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p_2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p_3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p_4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q_1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q_2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q_3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q_4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="o">==</span> <span class="mi">3</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Comparison to Press and Dyson formulation.</strong></p>
<p>In Press and Dyson’s work on their 2012 article. They have managed to prove
that:</p>
<div class="math notranslate nohighlight">
\[v \times S_{p} = \frac{D (p, q, S_{p})} {D (p, q, 1)}\]</div>
<p>where <span class="math notranslate nohighlight">\(D\)</span> is a <span class="math notranslate nohighlight">\(4 \times 4\)</span> the determinant of a defined matrix <span class="math notranslate nohighlight">\(B\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S_p</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">opt_mo</span><span class="o">.</span><span class="n">make_B</span><span class="p">(</span><span class="n">S_p</span><span class="p">,</span> <span class="p">(</span><span class="n">p_1</span><span class="p">,</span> <span class="n">p_2</span><span class="p">,</span> <span class="n">p_3</span><span class="p">,</span> <span class="n">p_4</span><span class="p">),</span> <span class="p">(</span><span class="n">q_1</span><span class="p">,</span> <span class="n">q_2</span><span class="p">,</span> <span class="n">q_3</span><span class="p">,</span> <span class="n">q_4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pd_utility</span><span class="p">(</span><span class="n">S_p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the utility as a function</span>
<span class="sd">    of p, q vectors. Based on Press and Dyson, 2012.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">opt_mo</span><span class="o">.</span><span class="n">make_B</span><span class="p">(</span><span class="n">S_p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="n">unit</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">opt_mo</span><span class="o">.</span><span class="n">make_B</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">B</span><span class="o">.</span><span class="n">det</span><span class="p">()</span> <span class="o">/</span> <span class="n">unit</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">pd_utility</span><span class="p">(</span><span class="n">S_p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">q_1</span><span class="p">,</span> <span class="n">q_2</span><span class="p">,</span> <span class="n">q_3</span><span class="p">,</span> <span class="n">q_4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="p">(</span>
    <span class="n">u</span> <span class="o">==</span> <span class="n">utility</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">S</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">R</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="n">P</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p_1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_4</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We have studied the numerator and the denominator of <span class="math notranslate nohighlight">\(u\)</span> separately.
Both the numerator and the denominator can be written as a general quadratic
form:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{2}pQp^T + c p^T + a\]</div>
<p>where <span class="math notranslate nohighlight">\(p\)</span> is an <span class="math notranslate nohighlight">\(n \times 1\)</span> column vector of variables, <span class="math notranslate nohighlight">\(Q\)</span> is a symetric <span class="math notranslate nohighlight">\(n \times n\)</span> matrix and a real-valued, <span class="math notranslate nohighlight">\(n\)</span>-dimensional vector <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>Thus the objective function <span class="math notranslate nohighlight">\(u\)</span> is the fraction/ratio of the two quadratic forms.</p>
<p>Information on quadratic programming can be found <a class="reference external" href="https://neos-guide.org/content/quadratic-programming,http://www.numerical.rl.ac.uk/people/nimg/qp/qp.html">here</a>.</p>
<p><strong>Our formulation.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">utility</span> <span class="o">=</span> <span class="n">pd_utility</span><span class="p">(</span><span class="n">S_p</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numerator</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">fraction</span><span class="p">(</span><span class="n">utility</span><span class="o">.</span><span class="n">simplify</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">denominator</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">fraction</span><span class="p">(</span><span class="n">utility</span><span class="o">.</span><span class="n">simplify</span><span class="p">())[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Numerator</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numerator</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1_Utility_and_Best responses_to_memory-one_players_33_0.png" src="_images/1_Utility_and_Best responses_to_memory-one_players_33_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">Q_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">numerator</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">f1</span> <span class="o">*</span> <span class="n">f2</span><span class="p">)</span> <span class="k">for</span> <span class="n">f2</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">f1</span> <span class="ow">in</span> <span class="n">p</span><span class="p">])</span>
<span class="n">c_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">numerator</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">p_2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_4</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">p_1</span><span class="p">),</span>
        <span class="n">numerator</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">p_1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_4</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">p_2</span><span class="p">),</span>
        <span class="n">numerator</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">p_1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_4</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">p_3</span><span class="p">),</span>
        <span class="n">numerator</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">p_1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_3</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">p_4</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">Q_num</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ps</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c_num</span><span class="p">,</span> <span class="n">ps</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">constant</span> <span class="o">=</span> <span class="n">numerator</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">-</span> <span class="n">expr</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">constant</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1_Utility_and_Best responses_to_memory-one_players_36_0.png" src="_images/1_Utility_and_Best responses_to_memory-one_players_36_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="p">(</span><span class="n">expr</span> <span class="o">+</span> <span class="n">constant</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
    <span class="p">{</span><span class="n">p_1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_4</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q_1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q_2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q_3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q_4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="p">)</span> <span class="o">==</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Q_num</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">element</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">Q_num</span><span class="p">])</span>
<span class="n">c_num</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">element</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">c_num</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
    <span class="p">[</span><span class="n">Q_num</span><span class="p">,</span> <span class="n">c_num</span><span class="p">,</span> <span class="n">constant</span><span class="o">.</span><span class="n">simplify</span><span class="p">()],</span>
    <span class="p">[</span><span class="s2">&quot;q_numerator&quot;</span><span class="p">,</span> <span class="s2">&quot;c_numerator&quot;</span><span class="p">,</span> <span class="s2">&quot;numerator_constant&quot;</span><span class="p">],</span>
<span class="p">):</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tex</span> <span class="o">/</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.tex&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">file</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Denominator</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Q_den</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">denominator</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">f1</span> <span class="o">*</span> <span class="n">f2</span><span class="p">)</span> <span class="k">for</span> <span class="n">f2</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">f1</span> <span class="ow">in</span> <span class="n">p</span><span class="p">])</span>
<span class="n">c_den</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">denominator</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">p_2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_4</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">p_1</span><span class="p">),</span>
        <span class="n">denominator</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">p_1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_4</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">p_2</span><span class="p">),</span>
        <span class="n">denominator</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">p_1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_4</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">p_3</span><span class="p">),</span>
        <span class="n">denominator</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">p_1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_3</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">p_4</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">Q_den</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ps</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c_den</span><span class="p">,</span> <span class="n">ps</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">den_constant</span> <span class="o">=</span> <span class="n">denominator</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">-</span> <span class="n">expr</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="p">(</span><span class="n">expr</span> <span class="o">+</span> <span class="n">den_constant</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span>
    <span class="p">{</span><span class="n">p_1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">p_4</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q_1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q_2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q_3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q_4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Q_den</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">element</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">Q_den</span><span class="p">])</span>
<span class="n">c_den</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">element</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">c_den</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
    <span class="p">[</span><span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">Q_den</span><span class="p">),</span> <span class="n">sym</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">c_den</span><span class="p">),</span> <span class="n">den_constant</span><span class="o">.</span><span class="n">simplify</span><span class="p">()],</span>
    <span class="p">[</span><span class="s2">&quot;q_denominator&quot;</span><span class="p">,</span> <span class="s2">&quot;c_denominator&quot;</span><span class="p">,</span> <span class="s2">&quot;denominator_constant&quot;</span><span class="p">],</span>
<span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tex</span> <span class="o">/</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.tex&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">file</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Validation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qs</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">filename</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
    <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="s2">&quot;against_player_one&quot;</span><span class="p">,</span> <span class="s2">&quot;against_player_two&quot;</span><span class="p">]</span>
<span class="p">):</span>

    <span class="n">theoritical</span> <span class="o">=</span> <span class="p">[</span><span class="n">opt_mo</span><span class="o">.</span><span class="n">match_utility</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qs</span><span class="p">]</span>
    <span class="n">simulated</span> <span class="o">=</span> <span class="p">[</span><span class="n">opt_mo</span><span class="o">.</span><span class="n">simulate_match_utility</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qs</span><span class="p">]</span>

    <span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">Fraction</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)]</span>
    <span class="n">xlabels</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">r</span><span class="s2">&quot;$\frac{&quot;</span> <span class="o">+</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;}{&quot;</span> <span class="o">+</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;}$&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xlabels</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">]</span>

    <span class="n">title</span> <span class="o">=</span> <span class="nb">str</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">Fraction</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">])</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">6.8</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">theoritical</span><span class="p">)),</span>
        <span class="n">theoritical</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$u_q(p)$&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">simulated</span><span class="p">)),</span>
        <span class="n">simulated</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$U_q(p)$&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$p=</span><span class="si">{}</span><span class="s2">$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">title</span><span class="p">)),</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">theoritical</span><span class="p">)),</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;$q_4$&quot;</span>
    <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">img_path</span> <span class="o">/</span> <span class="p">(</span><span class="s2">&quot;validation_</span><span class="si">{}</span><span class="s2">.pdf&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1_Utility_and_Best responses_to_memory-one_players_48_0.png" src="_images/1_Utility_and_Best responses_to_memory-one_players_48_0.png" />
<img alt="_images/1_Utility_and_Best responses_to_memory-one_players_48_1.png" src="_images/1_Utility_and_Best responses_to_memory-one_players_48_1.png" />
</div>
</div>
<p><strong>Tournament Utility</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">opponents</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">opt_mo</span><span class="o">.</span><span class="n">tournament_utility</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">opponents</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1_Utility_and_Best responses_to_memory-one_players_51_0.png" src="_images/1_Utility_and_Best responses_to_memory-one_players_51_0.png" />
</div>
</div>
<p><strong>Stewart &amp; Plotkin tournament</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">transitions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">4</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">8</span> <span class="o">/</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ps</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">simulated_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">ps</span><span class="p">:</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">opt_mo</span><span class="o">.</span><span class="n">simulate_tournament_utility</span><span class="p">(</span>
        <span class="n">player</span><span class="p">,</span> <span class="n">transitions</span><span class="p">,</span> <span class="n">turns</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">repetitions</span><span class="o">=</span><span class="mi">20</span>
    <span class="p">)</span>
    <span class="n">simulated_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/usr/share/miniconda/envs/opt-mo/lib/python3.7/site-packages/axelrod/result_set.py:413: RuntimeWarning: invalid value encountered in true_divide
  / sum(map(np.array, self.match_lengths))
</pre>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theoretical_values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">ps</span><span class="p">:</span>
    <span class="n">utility</span> <span class="o">=</span> <span class="n">opt_mo</span><span class="o">.</span><span class="n">tournament_utility</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">transitions</span><span class="p">)</span>
    <span class="n">theoretical_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">utility</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">6.8</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">theoretical_values</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{1}{10}</span><span class="s2"> \sum_{i = 1} ^ </span><span class="si">{10}</span><span class="s2"> u_q^{(i)} (p)$&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">simulated_scores</span><span class="p">)),</span>
    <span class="n">simulated_scores</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{1}{10}</span><span class="s2"> \sum_{i = 1} ^ </span><span class="si">{10}</span><span class="s2"> U_q^{(i)} (p)$&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Tournament of $N=10$&quot;</span><span class="p">),</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">Fraction</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)]</span>
<span class="n">xlabels</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sa">r</span><span class="s2">&quot;$\frac{&quot;</span> <span class="o">+</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;}{&quot;</span> <span class="o">+</span> <span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;}$&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xlabels</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span>
    <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">theoretical_values</span><span class="p">)),</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span>
<span class="p">),</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$q_4$&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">img_path</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;Stewart_tournament_results.pdf&quot;</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1_Utility_and_Best responses_to_memory-one_players_57_0.png" src="_images/1_Utility_and_Best responses_to_memory-one_players_57_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">players</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Fraction</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">limit_denominator</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ps</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">players</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">players</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">players</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="n">players</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
        <span class="n">simulated_scores</span><span class="p">,</span>
        <span class="n">theoretical_values</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sa">r</span><span class="s2">&quot;$p_1$&quot;</span><span class="p">,</span>
    <span class="sa">r</span><span class="s2">&quot;$p_2$&quot;</span><span class="p">,</span>
    <span class="sa">r</span><span class="s2">&quot;$p_3$&quot;</span><span class="p">,</span>
    <span class="sa">r</span><span class="s2">&quot;$p_4$&quot;</span><span class="p">,</span>
    <span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{1}{10}</span><span class="s2"> \sum\limits_{i = 1} ^ </span><span class="si">{10}</span><span class="s2"> u_q^{(i)} (p)$&quot;</span><span class="p">,</span>
    <span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{1}{10}</span><span class="s2"> \sum\limits_{i = 1} ^ </span><span class="si">{10}</span><span class="s2"> U_q^{(i)} (p)$&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>$p_1$</th>
      <th>$p_2$</th>
      <th>$p_3$</th>
      <th>$p_4$</th>
      <th>$\frac{1}{10} \sum\limits_{i = 1} ^ {10} u_q^{(i)} (p)$</th>
      <th>$\frac{1}{10} \sum\limits_{i = 1} ^ {10} U_q^{(i)} (p)$</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1/3</td>
      <td>1/3</td>
      <td>1/3</td>
      <td>0</td>
      <td>1.94975</td>
      <td>1.90388</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1/3</td>
      <td>1/3</td>
      <td>1/3</td>
      <td>1/19</td>
      <td>1.99975</td>
      <td>1.96031</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1/3</td>
      <td>1/3</td>
      <td>1/3</td>
      <td>2/19</td>
      <td>2.03595</td>
      <td>2.00053</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1/3</td>
      <td>1/3</td>
      <td>1/3</td>
      <td>3/19</td>
      <td>2.0363</td>
      <td>2.0304</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1/3</td>
      <td>1/3</td>
      <td>1/3</td>
      <td>4/19</td>
      <td>2.09695</td>
      <td>2.05327</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">textfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">tex</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;stewart_plotkin_simulation.tex&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="n">textfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">to_latex</span><span class="p">())</span>
<span class="n">textfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Mean player vs Average Utility</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p_one</span><span class="p">,</span> <span class="n">p_two</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">axl</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="n">opponents</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="n">mean_player</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">opponents</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>

<span class="n">av_utility</span> <span class="o">=</span> <span class="o">-</span><span class="n">opt_mo</span><span class="o">.</span><span class="n">tournament_utility</span><span class="p">((</span><span class="n">p_1</span><span class="p">,</span> <span class="n">p_2</span><span class="p">,</span> <span class="n">p_1</span><span class="p">,</span> <span class="n">p_2</span><span class="p">),</span> <span class="n">opponents</span><span class="p">)</span>
<span class="n">mn_utility</span> <span class="o">=</span> <span class="n">opt_mo</span><span class="o">.</span><span class="n">match_utility</span><span class="p">((</span><span class="n">p_1</span><span class="p">,</span> <span class="n">p_2</span><span class="p">,</span> <span class="n">p_1</span><span class="p">,</span> <span class="n">p_2</span><span class="p">),</span> <span class="n">mean_player</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">6.8</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">p_1</span><span class="p">,</span> <span class="n">p_2</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">av_utility</span> <span class="o">-</span> <span class="n">mn_utility</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">())</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">p_one</span><span class="p">,</span> <span class="n">p_two</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">expr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Tournament size $N=4$&quot;</span><span class="p">),</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$p_1$&quot;</span><span class="p">),</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$p_2$&quot;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">labelpad</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;$|\frac</span><span class="si">{1}{N}</span><span class="s2"> \sum_{i=1} ^ </span><span class="si">{N}</span><span class="s2"> </span><span class="si">{u_q}</span><span class="s2">^{(i)} (p) - u_{\frac </span><span class="si">{1}{N}</span><span class="s2"> \sum_{i=1} ^ N q^{(i)}}(p)$|&quot;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span>
    <span class="n">labelpad</span><span class="o">=+</span><span class="mi">45</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">img_path</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;mean_vs_average_heatmap.pdf&quot;</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1_Utility_and_Best responses_to_memory-one_players_65_0.png" src="_images/1_Utility_and_Best responses_to_memory-one_players_65_0.png" />
</div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright .<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.1.<br/>
    </p>
  </div>
</footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>